# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

This is a Claude Code plugin (v2.4.0) that provides specialized agents, commands (skills), and reusable patterns for Java 21+ / Spring Boot 4 and React development. The plugin enforces Virtual Thread compatibility throughout.

## Architecture

```
tuyens-claude-code/
├── agents/           # 10 specialized AI agents with domain expertise
├── commands/         # 9 user-invocable slash commands
├── skills/           # 21 reusable pattern libraries (referenced by agents/commands)
│   ├── backend/      # Spring Boot, JPA, async, transactions, WebSocket
│   ├── frontend/     # React components, state, memoization, WebSocket
│   ├── governance/   # API guidelines, coding standards
│   ├── integration/  # REST clients, idempotency
│   ├── ops/          # Observability, resiliency
│   └── performance/  # Caching, indexing, payload optimization
└── .claude-plugin/   # Plugin metadata (plugin.json, marketplace.json)
```

**Key relationship**: Commands invoke agents, and both reference skills for implementation patterns. Skills are the single source of truth for code patterns.

## File Formats

### Agents (`agents/*.md`)

```yaml
---
name: agent-name
description: Brief description
category: engineering
---
# Agent Name
## Triggers - When to use
## Focus Areas - Domain expertise
## Key Skills - Skills this agent references
## Key Actions - What it does
## Boundaries - Will/Will Not
```

### Commands (`commands/*.md`)

```yaml
---
description: What the command does
model: claude-opus-4-5 # optional model override
---
Command prompt with $ARGUMENTS placeholder
## Key Skills Reference - Skills to apply
```

### Skills (`skills/{category}/*.md`)

```yaml
---
name: skill-name
description: Brief description
category: category-name
tags: [tag1, tag2]
---
## When to Use
## Rules
## Pattern (with ❌ Bad / ✅ Good examples)
## Avoid
```

## Core Constraints

All code generated by this plugin must follow:

1. **Virtual Threads**: Never use `synchronized` blocks - use `ReentrantLock` instead. Connection pool size 10-40 (not 100+).
2. **Java 21+**: Records for DTOs, pattern matching, sealed classes where appropriate.
3. **Spring Boot 4**: Jakarta EE 11 namespace, constructor injection only, `@Transactional(readOnly = true)` by default.
4. **DTOs over Entities**: Never expose JPA entities in API responses.

## Shell Commands (Cross-Platform)

Use git and POSIX-compatible commands that work in Git Bash (Windows), macOS, and Linux:

| Operation             | Use This                  | NOT This                   |
| --------------------- | ------------------------- | -------------------------- |
| Delete tracked file   | `git rm file`             | `rm`, `del`, `Remove-Item` |
| Delete untracked file | `rm file` (with approval) | `del`, `Remove-Item`       |
| Move/rename file      | `git mv old new`          | `mv`, `move`, `Move-Item`  |
| Create directory      | `mkdir -p dir`            | `md`, `New-Item`           |
| Preview deletions     | `git clean -n`            | -                          |
| List files            | `ls`                      | `dir`, `Get-ChildItem`     |

See skill: `safe-file-operations` for complete patterns.

## Adding New Content

- **New agent**: Create `agents/{name}.md` following the frontmatter format
- **New command**: Create `commands/{name}.md` with `description` in frontmatter
- **New skill**: Create `skills/{category}/{name}.md` - use "When to Use", "Rules", "Pattern", "Avoid" sections

## After Making Changes

1. **Update plugin version**: Bump version in both `.claude-plugin/plugin.json` and `.claude-plugin/marketplace.json`
2. **Update CLAUDE.md**: Review and update this file if changes affect architecture, file formats, or constraints (add new memories, remove outdated ones)

## Skill Reference Syntax

In agents and commands, reference skills using:

```
Use skill: `skill-name` for description
```

This tells Claude to read and apply the skill's patterns.
